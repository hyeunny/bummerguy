<!DOCTYPE html>
<html>
<head>
  <script src="http://code.createjs.com/createjs-2013.02.12.min.js"></script>
  <style type="text/css">
    body {
      background-color: #EEE;
    }

    canvas {
      position: absolute;
      width: 720px;
      height: 624px;
      left: 50%;
      top: 50%;
      margin-left: -360px;
      margin-top: -312px;
      background-color: #666;

      /* Retro-ified */
      image-rendering: optimizeSpeed;
      image-rendering:-o-crisp-edges;
      image-rendering:-webkit-optimize-contrast;
      -ms-interpolation-mode: nearest-neighbor;
    }
  </style>

  <script src="http://code.jquery.com/jquery-1.9.1.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(function() {
      var TILE_WIDTH = 16;
      var TILE_HEIGHT = 16;
      var CANVAS_WIDTH = 240;
      var CANVAS_HEIGHT = 208;
      var BOMBERMAN_HEIGHT = 25;
      var BOMBERMAN_WIDTH = 14;
      var START_X = TILE_WIDTH;
      var START_Y = TILE_HEIGHT;

      var ctx = null,
          background = null,
          bomberman = null;

      function init() {
        // Prepare canvas
        $('canvas').attr('width', CANVAS_WIDTH).attr('height', CANVAS_HEIGHT);
        ctx = $('canvas').get(0).getContext('2d');
        // Retro-ified
        ctx.imageSmoothingEnabled = false;
        ctx.mozImageSmoothingEnabled = false;
        ctx.webkitImageSmoothingEnabled = false;

        ctx.fillText("hey", 100, 100);

        // Load background
        background = new Image();
        background.src = "images/background.png";
        bomberman = new Image();
        bomberman.src = "images/bomberman.png";

        background.onload = function() {
          drawBackground();
        };
        bomberman.onload = function(){
          drawBomberman();
        }
      }

      function drawBackground() {
        // Draw top border
        for (var x = 0; x < CANVAS_WIDTH; x += TILE_WIDTH) {
          ctx.drawImage(background, 0, 0, TILE_WIDTH, TILE_HEIGHT, x, 0, TILE_WIDTH, TILE_HEIGHT);
        }

        // Draw bottom border
        var y = CANVAS_HEIGHT - TILE_HEIGHT;
        for (var x = 0; x < CANVAS_WIDTH; x += TILE_WIDTH) {
          ctx.drawImage(background, 0, 0, TILE_WIDTH, TILE_HEIGHT, x, y, TILE_WIDTH, TILE_HEIGHT);
        }

        // Draw left border
        for (var y = 0; y < CANVAS_HEIGHT; y += TILE_HEIGHT) {
          ctx.drawImage(background, 0, 0, TILE_WIDTH, TILE_HEIGHT, 0, y, TILE_WIDTH, TILE_HEIGHT);
        }

        // Draw right border
        var x = CANVAS_WIDTH - TILE_WIDTH;
        for (var y = 0; y < CANVAS_HEIGHT; y += TILE_HEIGHT) {
          ctx.drawImage(background, 0, 0, TILE_WIDTH, TILE_HEIGHT, x, y, TILE_WIDTH, TILE_HEIGHT);
        }

        // Draw grass
        for (var y = TILE_HEIGHT; y < CANVAS_HEIGHT - TILE_HEIGHT; y += TILE_HEIGHT) {
          for (var x = TILE_WIDTH; x < CANVAS_WIDTH - TILE_WIDTH; x += TILE_WIDTH) {
            ctx.drawImage(background, TILE_WIDTH, TILE_HEIGHT, TILE_WIDTH, TILE_HEIGHT, x, y, TILE_WIDTH, TILE_HEIGHT);
          }
        }

        // Draw inside indestructible blocks
        for (var y = TILE_HEIGHT * 2; y < CANVAS_HEIGHT - TILE_HEIGHT * 2; y += TILE_HEIGHT * 2) {
          for (var x = TILE_WIDTH * 2; x < CANVAS_WIDTH - TILE_WIDTH * 2; x += TILE_WIDTH * 2) {
            ctx.drawImage(background, 0, 0, TILE_WIDTH, TILE_HEIGHT, x, y, TILE_WIDTH, TILE_HEIGHT);
          }
        }
      }

      function drawBomberman(){
        // Draw bomberman
        ctx.drawImage(bomberman, 34 , 46, BOMBERMAN_WIDTH, BOMBERMAN_HEIGHT, START_X, START_Y, BOMBERMAN_WIDTH, BOMBERMAN_HEIGHT);

      }

      init();
    });
  </script>
</head>
<body>
  <canvas></canvas>
</body>
</html>
